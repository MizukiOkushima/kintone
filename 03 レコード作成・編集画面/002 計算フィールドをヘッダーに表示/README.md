# 計算フィールドをヘッダーに表示
## 概要
計算フィールドで算出された値をレコード作成・編集画面のヘッダーに表示し常にフィールドの値を可視化する<br>

## 設定フィールド
| Type | 必須 | フィールド名 | フィールドコード or 要素ID | 初期値 | 設定値 |
| --- | --- | --- | --- | --- | --- |
| NUMBER | ◯ | 左辺 | 左辺 | 0 | - |
| NUMBER | ◯ | 右辺 | 右辺 | 0 | - |
| CALC | - | 加算 | 加算 | - | 左辺 + 右辺 |
| CALC | - | 減算 | 減算 | - | 左辺 - 右辺 |
| CALC | - | 乗算 | 乗算 | - | 左辺 * 右辺 |
| CALC | - | 除算 | 除算 | - | 左辺 / 右辺 |

## 解説
計算フィールドはチェンジイベントで用意されていないため処理を実装することにした<br>
チェンジイベントと異なり、フロントエンドではなくサーバー側で処理を実行していることを理解した<br>
つまり、kintoneのeventでは値が変わったかの判断がつかないため、<br>
setTimeout関数を使用し秒数指定の遅延処理にて処理を実装した<br>
<br>

```JavaScript

// 予備用セットタイマーをクリア
// セットしたタイマー（1000ms）の間に上乗せして実行するのを防ぐ
clearTimeout(subSetTimeout);

// 関数 計算フィールドの値を取得してHTMLタグに反映する ディレイ120ms
// 計算フィールドは体感60ms〜80msで取得できているようなので、余裕を見て120msを指定
setTimeout(updateHTMLTag, 120);

// 関数 計算フィールドの値を取得してHTMLタグに反映する ディレイ1000ms
// 予備用タイマーを実行することで、計算フィールドの値の反映が遅延されて表示が変化されないことを防ぐ
subSetTimeout = setTimeout(updateHTMLTag, 1000);

```


## 参考文献
なし

## イメージ
https://github.com/MizukiOkushima/kintone/assets/95268598/3efcc25d-3770-4169-a0fa-912d6efb9614

